{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": {
        "text": "Disasters and GSP Growth Over Time",
        "color": "white"
    },
    "background": "transparent",
    "params": [
        {
            "name": "YearStart",
            "value": 1990
        },
        {
            "name": "YearEnd",
            "value": 2024
        }
    ],
    "data": {
        "url": "data/state_gsp_disasters.json",
        "format": {
            "type": "json",
            "parse": {
                "State": "string",
                "Year": "number",
                "GSPGrowthPercent": "number",
                "NumberOfDisasters": "number"
            }
        }
    },
    "transform": [
        {
            "filter": "datum.Year >= YearStart && datum.Year <= YearEnd"
        },
        {
            "filter": {
                "field": "State",
                "oneOf": [
                    "Australian Capital Territory",
                    "New South Wales",
                    "Northern Territory",
                    "Queensland",
                    "South Australia",
                    "Tasmania",
                    "Victoria",
                    "Western Australia"
                ]
            }
        }
    ],
    "columns": 4,
    "facet": {
        "field": "State",
        "type": "nominal",
        "header": {
            "labelColor": "white",
            "titleColor": "white"
        }
    },
    "spec": {
        "height": 200,
        "width": 225,
        "layer": [
            {
                "mark": {
                    "type": "rule",
                    "color": "white",
                    "size": 1
                },
                "encoding": {
                    "y": {
                        "datum": 0
                    }
                }
            },
            {
                "transform": [
                    {
                        "calculate": "'GSP Growth (%)'",
                        "as": "Series"
                    }
                ],
                "mark": {
                    "type": "line",
                    "point": true
                },
                "encoding": {
                    "color": {
                        "field": "Series",
                        "type": "nominal",
                        "scale": {
                            "domain": [
                                "GSP Growth (%)",
                                "Number of Disasters"
                            ],
                            "range": [
                                "#000000",
                                "#1f77b4"
                            ]
                        },
                        "legend": {
                            "title": "Metric",
                            "orient": "bottom",
                            "direction": "horizontal",
                            "labelColor": "white",
                            "titleColor": "white"
                        }
                    },
                    "x": {
                        "field": "Year",
                        "type": "ordinal",
                        "axis": {
                            "title": "Year",
                            "labelColor": "white",
                            "titleColor": "white",
                            "tickMinStep": 5,
                            "values": [
                                1990,
                                1995,
                                2000,
                                2005,
                                2010,
                                2015,
                                2020,
                                2025
                            ]
                        }
                    },
                    "y": {
                        "field": "GSPGrowthPercent",
                        "type": "quantitative",
                        "scale": {
                            "domain": [
                                -5,
                                15
                            ],
                            "nice": false
                        },
                        "axis": {
                            "title": "GSP Growth (%)",
                            "orient": "right",
                            "labelColor": "white",
                            "titleColor": "white"
                        }
                    },
                    "tooltip": [
                        {
                            "field": "State",
                            "type": "nominal",
                            "title": "State"
                        },
                        {
                            "field": "Year",
                            "type": "ordinal",
                            "title": "Year"
                        },
                        {
                            "field": "GSPGrowthPercent",
                            "type": "quantitative",
                            "title": "GSP Growth (%)"
                        }
                    ]
                }
            },
            {
                "transform": [
                    {
                        "calculate": "'Number of Disasters'",
                        "as": "Series"
                    }
                ],
                "mark": {
                    "type": "bar",
                    "opacity": 0.6
                },
                "encoding": {
                    "color": {
                        "field": "Series",
                        "type": "nominal",
                        "scale": {
                            "domain": [
                                "GSP Growth (%)",
                                "Number of Disasters"
                            ],
                            "range": [
                                "#000000",
                                "#1f77b4"
                            ]
                        },
                        "legend": {
                            "title": "Metric"
                        }
                    },
                    "x": {
                        "field": "Year",
                        "type": "ordinal",
                        "axis": {
                            "title": "Year",
                            "labelColor": "white",
                            "titleColor": "white",
                            "tickMinStep": 5,
                            "values": [
                                1990,
                                1995,
                                2000,
                                2005,
                                2010,
                                2015,
                                2020,
                                2025
                            ]
                        }
                    },
                    "y": {
                        "field": "NumberOfDisasters",
                        "type": "quantitative",
                        "scale": {
                            "domain": [
                                -5,
                                15
                            ],
                            "nice": false
                        },
                        "axis": {
                            "title": "Number of Disasters",
                            "labelColor": "white",
                            "titleColor": "white",
                            "orient": "left"
                        }
                    },
                    "tooltip": [
                        {
                            "field": "State",
                            "type": "nominal",
                            "title": "State"
                        },
                        {
                            "field": "Year",
                            "type": "quantitative",
                            "title": "Year"
                        },
                        {
                            "field": "NumberOfDisasters",
                            "type": "quantitative",
                            "title": "Number of Disasters"
                        }
                    ]
                }
            },
            {
                "transform": [
                    {
                        "filter": "datum.State == 'Queensland' && datum.Year == 2020"
                    }
                ],
                "layer": [
                    {
                        "mark": {
                            "type": "point",
                            "shape": "triangle-up",
                            "size": 100,
                            "color": "#ff0000",
                            "fill": "#ff0000"
                        },
                        "encoding": {
                            "x": {
                                "field": "Year",
                                "type": "ordinal"
                            },
                            "y": {
                                "field": "GSPGrowthPercent",
                                "type": "quantitative",
                                "axis": null
                            },
                            "tooltip": [
                                {
                                    "field": "State",
                                    "type": "nominal",
                                    "title": "State"
                                },
                                {
                                    "field": "Year",
                                    "type": "ordinal",
                                    "title": "Year"
                                },
                                {
                                    "field": "GSPGrowthPercent",
                                    "type": "quantitative",
                                    "title": "GSP Growth (%)"
                                }
                            ]
                        }
                    },
                    {
                        "mark": {
                            "type": "text",
                            "align": "left",
                            "baseline": "middle",
                            "dx": -100,
                            "dy": 15,
                            "fontSize": 11,
                            "color": "#000000"
                        },
                        "encoding": {
                            "x": {
                                "field": "Year",
                                "type": "ordinal"
                            },
                            "y": {
                                "field": "GSPGrowthPercent",
                                "type": "quantitative",
                                "axis": null
                            },
                            "text": {
                                "value": "2020: fires + COVID hit growth"
                            }
                        }
                    }
                ]
            },
            {
                "transform": [
                    {
                        "filter": "datum.State == 'Victoria' && datum.Year == 1991"
                    }
                ],
                "layer": [
                    {
                        "mark": {
                            "type": "point",
                            "shape": "triangle-up",
                            "size": 100,
                            "color": "#ff0000",
                            "fill": "#ff0000"
                        },
                        "encoding": {
                            "x": {
                                "field": "Year",
                                "type": "ordinal"
                            },
                            "y": {
                                "field": "GSPGrowthPercent",
                                "type": "quantitative",
                                "axis": null
                            },
                            "tooltip": [
                                {
                                    "field": "State",
                                    "type": "nominal",
                                    "title": "State"
                                },
                                {
                                    "field": "Year",
                                    "type": "ordinal",
                                    "title": "Year"
                                },
                                {
                                    "field": "GSPGrowthPercent",
                                    "type": "quantitative",
                                    "title": "GSP Growth (%)"
                                }
                            ]
                        }
                    },
                    {
                        "mark": {
                            "type": "text",
                            "align": "right",
                            "baseline": "top",
                            "dx": 155,
                            "dy": -5,
                            "fontSize": 11,
                            "color": "#000000"
                        },
                        "encoding": {
                            "x": {
                                "field": "Year",
                                "type": "ordinal"
                            },
                            "y": {
                                "field": "GSPGrowthPercent",
                                "type": "quantitative",
                                "axis": null
                            },
                            "text": {
                                "value": "1991: recession + 2 disasters"
                            }
                        }
                    }
                ]
            },
            {
                "transform": [
                    {
                        "filter": "datum.State == 'New South Wales' && datum.Year == 2001"
                    }
                ],
                "layer": [
                    {
                        "mark": {
                            "type": "point",
                            "shape": "triangle-up",
                            "size": 100,
                            "color": "#ff0000",
                            "fill": "#ff0000"
                        },
                        "encoding": {
                            "x": {
                                "field": "Year",
                                "type": "ordinal"
                            },
                            "y": {
                                "field": "GSPGrowthPercent",
                                "type": "quantitative",
                                "axis": null
                            },
                            "tooltip": [
                                {
                                    "field": "State",
                                    "type": "nominal",
                                    "title": "State"
                                },
                                {
                                    "field": "Year",
                                    "type": "ordinal",
                                    "title": "Year"
                                },
                                {
                                    "field": "GSPGrowthPercent",
                                    "type": "quantitative",
                                    "title": "GSP Growth (%)"
                                }
                            ]
                        }
                    },
                    {
                        "mark": {
                            "type": "text",
                            "align": "right",
                            "baseline": "top",
                            "dx": 100,
                            "dy": 25,
                            "fontSize": 11,
                            "color": "#000000"
                        },
                        "encoding": {
                            "x": {
                                "field": "Year",
                                "type": "ordinal"
                            },
                            "y": {
                                "field": "GSPGrowthPercent",
                                "type": "quantitative",
                                "axis": null
                            },
                            "text": {
                                "value": "2001: Black Christmas Bushfires"
                            }
                        }
                    }
                ]
            }
        ]
    },
    "resolve": {
        "scale": {
            "y": "independent"
        }
    }
}