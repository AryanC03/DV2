{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Small multiples comparing disaster counts and GSP growth by state.",
  "title": {
    "text": "Disasters and GSP Growth Over Time",
    "color": "white"
  },
  "background": "transparent",
  "autosize": {
    "type": "fit-x",
    "contains": "padding"
  },
  "data": {
    "url": "data/gsp.csv",
    "format": {
      "type": "csv",
      "parse": {
        "State": "string",
        "Year": "number",
        "GSPGrowthPercent": "number"
      }
    }
  },
  "transform": [
    {
      "filter": "datum.Year >= 1990 && datum.Year <= 2024"
    },
    {
      "filter": {
        "field": "State",
        "oneOf": [
          "Australian Capital Territory",
          "New South Wales",
          "Northern Territory",
          "Queensland",
          "South Australia",
          "Tasmania",
          "Victoria",
          "Western Australia"
        ]
      }
    },
    {
      "lookup": "state_year",
      "from": {
        "data": {
          "url": "data/disasters_year.csv",
          "format": {
            "type": "csv",
            "parse": {
              "NumberOfDisasters": "number"
            }
          }
        },
        "key": "state_year",
        "fields": [
          "NumberOfDisasters"
        ]
      },
      "default": 0
    },
    {
      "impute": "NumberOfDisasters",
      "key": "Year",
      "groupby": [
        "State"
      ],
      "value": 0
    }
  ],
  "columns": 4,
  "facet": {
    "field": "State",
    "type": "nominal",
    
    "sort": [
      "Australian Capital Territory",
      "New South Wales",
      "Northern Territory",
      "Queensland",
      "South Australia",
      "Tasmania",
      "Victoria",
      "Western Australia"
    ],
    "title": null,
    "header": {
      "labelColor": "white",
      "titleColor": "white"
    }
  },
  "spec": {
    "width": 150,
    "height": 150,
    "layer": [
      {
        "mark": {
          "type": "bar",
          "color": "#454545",
          "opacity": 0.7
        },
        "encoding": {
          "x": {
            "field": "Year",
            "type": "ordinal",
            "sort": "ascending",
            "axis": {
              "title": "Year",
              "labelAngle": -45,
              "labelColor": "white",
              "titleColor": "white",
              "tickMinStep": 5,
              "values": [
                1990,
                1995,
                2000,
                2005,
                2010,
                2015,
                2020,
                2025
              ]
            }
          },
          "y": {
            "field": "NumberOfDisasters",
            "type": "quantitative",
            "axis": {
              "title": "Disasters",
              "labelColor": "white",
              "titleColor": "white",
              "tickCount": 5,
              "tickMinStep": 1
            }
          },
          "tooltip": [
            {
              "field": "State",
              "type": "nominal",
              "title": "State"
            },
            {
              "field": "Year",
              "type": "ordinal",
              "title": "Year"
            },
            {
              "field": "NumberOfDisasters",
              "type": "quantitative",
              "title": "Disasters"
            }
          ]
        }
      },
      {
        "mark": {
          "type": "line",
          "color": "#FFA500",
          "strokeWidth": 2,
          "point": true
        },
        "encoding": {
          "x": {
            "field": "Year",
            "type": "ordinal",
            "sort": "ascending"
          },
          "y": {
            "field": "GSPGrowthPercent",
            "type": "quantitative",
            "axis": {
              "title": "GSP growth (%)",
              "orient": "right",
              "labelColor": "white",
              "titleColor": "white"
            }
          },
          "tooltip": [
            {
              "field": "State",
              "type": "nominal",
              "title": "State"
            },
            {
              "field": "Year",
              "type": "ordinal",
              "title": "Year"
            },
            {
              "field": "GSPGrowthPercent",
              "type": "quantitative",
              "title": "GSP Growth (%)",
              "format": ".2f"
            }
          ]
        }
      }
    ]
  },
  "resolve": {
    "scale": {
      "y": "independent"
    }
  }
}
