<!DOCTYPE html>
<html>

<head>
  <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.0"></script>

  <!-- CSS file -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">


</head>

<body>
  <main>
    <div class="header-card">
      <h1 style="font-size: xx-large;">Major Disaster Events in Australia</h1>
      <p style="font-size: smaller;">by Aryan Chordia</p>
    </div>
    <div class="card">
      <div id="state-buttons" class="state-button-bar">
        <button type="button" data-state="Australia" class="state-btn active">Australia</button>
        <button type="button" data-state="Australian Capital Territory" class="state-btn">Australian Capital
          Territory</button>
        <button type="button" data-state="New South Wales" class="state-btn">New South Wales</button>
        <button type="button" data-state="Northern Territory" class="state-btn">Northern Territory</button>
        <button type="button" data-state="Queensland" class="state-btn">Queensland</button>
        <button type="button" data-state="South Australia" class="state-btn">South Australia</button>
        <button type="button" data-state="Tasmania" class="state-btn">Tasmania</button>
        <button type="button" data-state="Victoria" class="state-btn">Victoria</button>
        <button type="button" data-state="Western Australia" class="state-btn">Western Australia</button>
      </div>
      <div class="row70">
        <div id="symbol_map" class="column70"></div>
        <div id="treemap" class="column70" style="padding-right: 1cm;"></div>
      </div>
      <div id="zoom-disaster-buttons">
        <input type="range" class="slider" min="900" max="4000" step="50" id="myRange">
      </div>
      <div class="state-text">
        <p style="font-size: larger;"></p>
      </div>

      <table class="disaster-gallery">
        <tr>
          <td>
            <img src="images/bushfire.jpg">
          </td>
          <td>
            <img src="images/flood.jpg">
          </td>
          <td>
            <img src="images/cyclone.jpg">
          </td>
          <td>
            <img src="images/storm.jpg">
          </td>
          <td>
            <img src="images/earthquake.jpg">
          </td>
        </tr>
        <tr>
          <td class="img-subcaption">Bushfire</td>
          <td class="img-subcaption">Flood</td>
          <td class="img-subcaption">Cyclone</td>
          <td class="img-subcaption">Storm</td>
          <td class="img-subcaption">Earthquake</td>
        </tr>
        <tr>
          <td class="img-caption">Frequent during hot, dry summers, Australian bushfires are among the most destructive
            natural disasters, often devastating vast forests and communities.</td>
          <td class="img-caption">Floods in Australia can result from heavy rainfall, cyclones, or river overflows,
            leading to significant damage to homes, infrastructure, and agriculture.</td>
          <td class="img-caption">Cyclones, particularly in northern Australia, bring strong winds and heavy rains,
            causing widespread destruction and flooding.</td>
          <td class="img-caption">Severe storms, including hailstorms and thunderstorms, can cause localized damage
            through high winds, lightning, and heavy rainfall.</td>
          <td class="img-caption">While less common, earthquakes do occur in Australia, particularly in regions like
            South
            Australia and Victoria, sometimes causing structural damage.</td>
        </tr>
      </table>
    </div>

    <div class="card">
      <h2 style="text-align: center; font-weight: bold; font-size: x-large;">Impact on Gross State Product (GSP)</h2>

      <div class="row50">
        <div id="bar_line_single" class="column50"></div>
        <p style="padding-left:2cm; font-size: large;">From 1990 to 2021, Australia averaged around 4-5 major disasters each year, while
          national Gross State Product (GSP) growth remained steady at approximately 3.1%. The weak positive correlation
          between disaster frequency and GSP growth (r â‰ˆ 0.11) indicates little to no consistent relationship, meaning
          years with more disasters did not necessarily coincide with slower or faster economic performance. Despite
          major events such as the Black Saturday and Black Summer bushfires, the Australian economy showed strong
          resilience, with sectors like mining and construction often compensating for regional losses. Since the 2000s,
          disaster frequency has become more variable, but national growth has stayed stable, suggesting that while
          disasters cause short-term and local disruptions, they have limited long-term impact on Australia's overall
          economic trajectory. In some cases, recovery and reconstruction efforts may even stimulate temporary economic
          growth.</p>
      </div>
    </div>

    <div class="card">
      <h2 style="text-align: center;">Data Sources</h2>
      <p style="font-size: small;"><b>Disaster Data: Australian Disaster Resilience Knowledge Hub</b>
        (https://knowledge.aidr.org.au/resources/data-sources/)</p>
      <p style="font-size: small;"><b>Economic Data: Australian Bureau of Statistics </b>(https://www.abs.gov.au/statistics/economy/national-accounts/australian-national-accounts-state-accounts/latest-release#data-downloads)</p>
      <p style="font-size: small;"><b>Employment and Unemployment Data: Australia Bureau of Statistics</b> (https://www.abs.gov.au/statistics/labour/employment-and-unemployment/labour-force-australia-detailed/latest-release#all-data-downloads)</p>
    </div>


  </main>

  <script type="text/javascript">

    var zoomValue = document.getElementById('myRange');
    zoomValue.value = 1000; // Default zoom level
    zoomValue.addEventListener('input', function () {
      if (symbolMapView) {
        symbolMapView.signal('Zoom', +zoomValue.value).runAsync();
      }
    });

    var stateDescriptions = {};
    fetch('data/descriptions.json').then(response => response.json()).then(data => {
      stateDescriptions = data;
      stateTextElement.textContent = stateDescriptions[currentState];
    })
      .catch(error => console.error('Error loading state descriptions:', error));

    var stateButtons = document.querySelectorAll('#state-buttons .state-btn');
    var stateCenters = {
      "Australia": [133, -27],
      "Australian Capital Territory": [149, -35],
      "New South Wales": [147, -31],
      "Northern Territory": [130, -20],
      "Queensland": [153, -28],
      "South Australia": [138, -34],
      "Tasmania": [146, -42],
      "Victoria": [143, -37],
      "Western Australia": [121, -25]
    };
    var barLineSingleStates = [
      "Australian Capital Territory",
      "New South Wales",
      "Northern Territory",
      "Queensland",
      "South Australia",
      "Tasmania",
      "Victoria",
      "Western Australia"
    ];
    var currentState = 'Australia';
    var symbolMapView = null;
    var treemapView = null;
    var barLineSingleView = null;
    var stateTextElement = document.querySelector('.state-text p');

    function setActiveButton(value) {
      stateButtons.forEach(function (btn) {
        var isActive = btn.dataset.state === value;
        btn.classList.toggle('active', isActive);
      });
    }

    function applyStateToMap(value) {
      if (!symbolMapView) {
        return;
      }
      var centre = stateCenters[value] || stateCenters['Australia'];
      symbolMapView.signal('StateFilter', value);
      symbolMapView.signal('centre_to', centre);
      symbolMapView.runAsync();
    }

    function updateStateFromUI(value) {
      currentState = value;
      setActiveButton(value);
      if (treemapView) {
        treemapView.signal('selectedState', value).runAsync();
      }
      if (barLineSingleView && barLineSingleStates.includes(value)) {
        barLineSingleView.signal('selectedState', value).runAsync();
      }
      applyStateToMap(value);

      stateTextElement.textContent = stateDescriptions[value];
    }

    setActiveButton(currentState);

    stateButtons.forEach(function (button) {
      button.addEventListener('click', function () {
        updateStateFromUI(button.dataset.state);
      });
    });


    var spec2 = "js/symbol_map.vg.json";
    vegaEmbed('#symbol_map', spec2).then(function (result) {
      symbolMapView = result.view;
      applyStateToMap(currentState);
    }).catch(console.error);

    var spec3 = "js/treemap.vg.json";
    vegaEmbed('#treemap', spec3).then(function (result) {
      treemapView = result.view;
      treemapView.addSignalListener('selectedState', function (name, value) {
        if (value !== currentState) {
          currentState = value;
          setActiveButton(value);
          applyStateToMap(value);
        }
      });

      if (treemapView.signal('selectedState') !== currentState) {
        treemapView.signal('selectedState', currentState).runAsync();
      }
      setActiveButton(currentState);
      applyStateToMap(currentState);
    }).catch(console.error);

    // var spec4 = "js/bar_line_multiples.vg.json";
    // vegaEmbed('#bar_line_multiples', spec4).catch(console.error);

    var spec5 = 'js/bar_line_single.vg.json';
    vegaEmbed('#bar_line_single', spec5).catch(console.error);
  </script>

</body>

</html>