<!DOCTYPE html>
<html>

<head>
  <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.0"></script>

  <!-- CSS file -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">


</head>

<body>
  <main>
    <div class="card1">
      <h1 style="font-size: 60px;">MAJOR DISASTER EVENTS IMPACT ON <span
          style="color: rgb(0, 0, 0); font-weight: bold; text-align: center;">AUSTRALIAN ECONOMY</span></h1>

      <h2 style="text-align: center; font-size: 30px"> <span
          style="color: rgb(0, 0, 0); font-weight: bold;">NATURAL</span>
        DISASTERS</h2>

      <div>
        <p style="font-style: italic; text-align: center;">The true <span
            style="color: rgb(0, 0, 0); font-weight: bold;">toll</span> of Australia's worst natural disasters.
          Bushfires,
          floods, cyclones, storms, and earthquakes.
        </p>
      </div>

      <div id="state-buttons" class="state-button-bar">
        <button type="button" data-state="Australia" class="state-btn active">Australia</button>
        <button type="button" data-state="Australian Capital Territory" class="state-btn">Australian Capital
          Territory</button>
        <button type="button" data-state="New South Wales" class="state-btn">New South Wales</button>
        <button type="button" data-state="Northern Territory" class="state-btn">Northern Territory</button>
        <button type="button" data-state="Queensland" class="state-btn">Queensland</button>
        <button type="button" data-state="South Australia" class="state-btn">South Australia</button>
        <button type="button" data-state="Tasmania" class="state-btn">Tasmania</button>
        <button type="button" data-state="Victoria" class="state-btn">Victoria</button>
        <button type="button" data-state="Western Australia" class="state-btn">Western Australia</button>
      </div>
      <p style="font-size: x-small;">* Pick a state to see further information.</p>

      <div id="year-range">
        <p><span style="color: #000; font-weight: bold;">Filter</span> by Year
        <p>
        <div id="year_brush"></div>
      </div>

      <div class="row70">

        <div id="symbol_map" class="column70"></div>
        <div id="treemap" class="column70" style="padding-right: 1cm;"></div>
      </div>

      <div>
        <p style="font-size: xx-small;">* Note some states may not align with the states where they are positioned.</p>
      </div>

      <p style="font-size: large;">
        ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      </p>

      <div>
        <h2 style="text-align: center; font-size: 30px; padding-top: 1cm;">GROSS STATE PRODUCT (GSP) <span
            style="color: rgb(0, 0, 0); font-weight: bold;">IMPACT</span>
        </h2>
        <p style=" text-align: center; font-style: italic;">Disaster counts spike and crash across states, yet GSP
          growth rarely falls below zero. Highlighting how <span
            style="color: black; font-weight: bold;">resilient</span> each economy remains even as extreme events
          intensify.</p>
        <div id="bar_line_multiples"></div>
      </div>
      <p style="font-size: large;">
        ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      </p>
      <div>
        <h2 style="text-align: center; font-size: 30px; padding-top: 1cm;">IMPACT ON <span
            style="color: rgb(0, 0, 0); font-weight: bold;">UNEMPLOYMENT</span>
          <p style="font-style: italic;">States facing repeated disaster seasons, Queensland in 2011's <span
              style="color: rgb(0, 0, 0); font-weight: bold;">floods</span> and Victoria after the 2019-20
            <span style="color: rgb(0, 0, 0); font-weight: bold;">bushfires</span>, show darker unemployment bands in
            the ensuing months, hinting that recovery efforts lag where the
            shocks hit hardest.
          </p>
          <div id="heatmap"></div>
      </div>

      <p style="font-size: large;">
        ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      </p>
      <h2 style="text-align: center;"><b>Metadata</b></h2>
      <p style="margin-top: 4px; font-size: small;"><span style="font-weight: bold;">Author: </span>Aryan Chordia</p>
      <p style="font-size: small;"><span style="font-weight: bold;">Date: </span> 20/10/2025</p>
      <p style="font-size: small;"><b>Sources:</b></p>
      <p style="font-size: smaller;">Disaster Data: Australian Disaster Resilience Knowledge Hub
        (https://knowledge.aidr.org.au/resources/data-sources/)</p>
      <p style="font-size: smaller;">Economic Data: Australian Bureau of Statistics
        (https://www.abs.gov.au/statistics/economy/national-accounts/australian-national-accounts-state-accounts/latest-release#data-downloads)
      </p>
      <p style="font-size: smaller;">Employment and Unemployment Data: Australia Bureau of Statistics
        (https://www.abs.gov.au/statistics/labour/employment-and-unemployment/labour-force-australia-detailed/latest-release#all-data-downloads)
      </p>

    </div>
  </main>

  <script type="text/javascript">
    var stateDescriptions = window.stateDescriptions || {};

    var stateButtons = document.querySelectorAll('#state-buttons .state-btn');
    var stateCenters = {
      "Australia": [133, -27],
      "Australian Capital Territory": [149, -35],
      "New South Wales": [147, -31],
      "Northern Territory": [130, -20],
      "Queensland": [153, -28],
      "South Australia": [138, -34],
      "Tasmania": [146, -42],
      "Victoria": [143, -37],
      "Western Australia": [121, -25]
    };

    var barLineSingleStates = [
      "Australian Capital Territory",
      "New South Wales",
      "Northern Territory",
      "Queensland",
      "South Australia",
      "Tasmania",
      "Victoria",
      "Western Australia"
    ];
    var currentState = 'Australia';
    var yearStart = 1990;
    var yearEnd = 2024;
    var symbolMapView = null;
    var treemapView = null;
    var barLineSingleView = null;
    var barLineMultiplesView = null;
    var timelineView = null;
    var heatmapView = null;

    function setActiveButton(value) {
      stateButtons.forEach(function (btn) {
        var isActive = btn.dataset.state === value;
        btn.classList.toggle('active', isActive);
      });
    }

    function applyYearRangeToViews() {
      if (symbolMapView) {
        symbolMapView.signal('YearStart', yearStart);
        symbolMapView.signal('YearEnd', yearEnd);
        symbolMapView.runAsync();
      }
      if (barLineMultiplesView) {
        barLineMultiplesView.signal('YearStart', yearStart);
        barLineMultiplesView.signal('YearEnd', yearEnd);
        barLineMultiplesView.runAsync();
      }
      if (heatmapView) {
        heatmapView.signal('YearStart', yearStart);
        heatmapView.signal('YearEnd', yearEnd);
        heatmapView.runAsync();
      }
    }

    function setYearRangeFromBrush(value) {
      var range = null;
      if (value && value.Year) {
        range = value.Year;
      } else if (Array.isArray(value) && value.length > 0 && value[0].Year) {
        range = value[0].Year;
      }
      if (!range) {
        range = [1990, 2024];
      }
      var rangeCopy = Array.isArray(range) ? range.slice() : [range[0], range[1]];
      var start = Math.round(rangeCopy[0]);
      var end = Math.round(rangeCopy[1]);
      if (isNaN(start) || isNaN(end)) {
        start = 1990;
        end = 2024;
      }
      start = Math.max(1990, start);
      end = Math.min(2024, end);
      if (start === yearStart && end === yearEnd) {
        return;
      }
      yearStart = start;
      yearEnd = end;
      applyYearRangeToViews();
    }

    function applyStateToMap(value) {
      if (!symbolMapView) {
        return;
      }
      var centre = stateCenters[value] || stateCenters['Australia'];
      symbolMapView.signal('StateFilter', value);
      symbolMapView.signal('centre_to', centre);
      symbolMapView.signal('YearStart', yearStart);
      symbolMapView.signal('YearEnd', yearEnd);
      symbolMapView.runAsync();
    }

    function updateStateFromUI(value) {
      currentState = value;
      setActiveButton(value);
      if (treemapView) {
        treemapView.signal('selectedState', value).runAsync();
      }
      if (barLineSingleView && barLineSingleStates.includes(value)) {
        barLineSingleView.signal('selectedState', value).runAsync();
      }
      applyStateToMap(value);

      if (stateTextElement) {
        stateTextElement.textContent = stateDescriptions[value];
      }
      applyYearRangeToViews();
    }

    setActiveButton(currentState);

    stateButtons.forEach(function (button) {
      button.addEventListener('click', function () {
        updateStateFromUI(button.dataset.state);
      });
    });


    var specYear = 'js/year_brush.vg.json';
    vegaEmbed('#year_brush', specYear).then(function (result) {
      timelineView = result.view;
      var initial = timelineView.signal('yearBrush');
      setYearRangeFromBrush(initial);

      timelineView.addSignalListener('yearBrush', function (name, value) {
        setYearRangeFromBrush(value);
      });
    }).catch(console.error);

    var spec2 = "js/symbol_map.vg.json";
    vegaEmbed('#symbol_map', spec2).then(function (result) {
      symbolMapView = result.view;
      applyStateToMap(currentState);
      applyYearRangeToViews();
    }).catch(console.error);

    var spec3 = "js/treemap.vg.json";
    vegaEmbed('#treemap', spec3).then(function (result) {
      treemapView = result.view;
      treemapView.addSignalListener('selectedState', function (name, value) {
        if (value !== currentState) {
          currentState = value;
          setActiveButton(value);
          applyStateToMap(value);
        }
      });

      if (treemapView.signal('selectedState') !== currentState) {
        treemapView.signal('selectedState', currentState).runAsync();
      }
      setActiveButton(currentState);
      applyStateToMap(currentState);
    }).catch(console.error);

    var spec6 = 'js/test_bar_line_mini.vg.json';
    vegaEmbed('#bar_line_multiples', spec6).then(function (result) {
      barLineMultiplesView = result.view;
      applyYearRangeToViews();
    }).catch(console.error);

    var specHeatmap = 'js/heatmap.vg.json';
    vegaEmbed('#heatmap', specHeatmap).then(function (result) {
      heatmapView = result.view;
      applyYearRangeToViews();
    }).catch(console.error);

  </script>

</body>

</html>